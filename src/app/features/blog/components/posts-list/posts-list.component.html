<section class="mt-14 flex flex-col gap-8 container mx-auto">
  <div class="flex flex-col gap-4 md:flex-row justify-between items-center">
    <h1 class="text-xl font-medium">Últimas notícias</h1>
    <div class="flex gap-4 items-center">
      <div class="relative w-96">
        <input
          type="text"
          id="search"
          class="w-full py-2 pl-10 pr-4 border rounded-lg text-gray-700 focus:outline-none transition-all duration-300"
          placeholder="Busque notícias"
          (input)="search($event)"
        />
        <div
          class="absolute inset-y-0 start-0 flex items-center ps-3 pointer-events-none"
        >
          <svg
            class="w-4 h-4 text-gray-500 dark:text-gray-400"
            aria-hidden="true"
            xmlns="http://www.w3.org/2000/svg"
            fill="none"
            viewBox="0 0 20 20"
          >
            <path
              stroke="currentColor"
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="m19 19-4-4m0-7A7 7 0 1 1 1 8a7 7 0 0 1 14 0Z"
            />
          </svg>
        </div>
      </div>
      <button
        (click)="toggleView()"
        class="px-4 py-2 rounded-lg bg-gray-800 text-white text-sm hover:bg-gray-900 transition cursor-pointer"
      >
        {{ isVertical() ? "Ver em grade" : "Ver em lista" }}
      </button>
    </div>
  </div>

  @if (isLoading()) {
  <div class="grid grid-cols-4 gap-8">
    <div class="animate-pulse flex flex-col space-y-4">
      <div class="bg-gray-300 rounded-xl h-48 w-full"></div>
      <div class="bg-gray-300 rounded h-6 w-3/4"></div>
      <div class="bg-gray-300 rounded h-4 w-full"></div>
    </div>
    <div class="animate-pulse flex flex-col space-y-4">
      <div class="bg-gray-300 rounded-xl h-48 w-full"></div>
      <div class="bg-gray-300 rounded h-6 w-3/4"></div>
      <div class="bg-gray-300 rounded h-4 w-full"></div>
    </div>
    <div class="animate-pulse flex flex-col space-y-4">
      <div class="bg-gray-300 rounded-xl h-48 w-full"></div>
      <div class="bg-gray-300 rounded h-6 w-3/4"></div>
      <div class="bg-gray-300 rounded h-4 w-full"></div>
    </div>
  </div>
  } @else {
  <div
    [ngClass]="
      isVertical() ? 'grid grid-cols-2 gap-8' : 'grid grid-cols-4 gap-8'
    "
  >
    @if (dataIsEmpty()) {
      <div class="flex items-center">Nenhuma postagem</div>
      } @else {
        @for (item of currentPageData(); track $index) {
          <a
            [href]="'/posts/' + item.id"
            class="cursor-pointer rounded-2xl transition duration-500 flex"
            [ngClass]="isVertical() ? 'flex-row items-center' : 'flex-col'"
          >
            <div
              class="overflow-hidden rounded-xl"
              [ngClass]="
                isVertical() ? 'w-28 h-28 mr-6 flex-shrink-0' : 'w-full h-36 mb-4'
              "
            >
              <img
                src="https://picsum.photos/200/300"
                alt="Notícia"
                class="w-full h-full object-cover"
              />
            </div>
            <div class="flex flex-col">
              <h1 class="text-lg text-gray-700 font-semibold">
                {{ item.title | ellipsis : 32 }}
              </h1>
              <p class="mt-3 text-sm text-gray-600">
                {{ item.body | ellipsis : 120 }}
              </p>
              <div class="mt-3 text-gray-700">{{ item.author?.name }}</div>
            </div>
          </a>
          }
    }
  </div>

  <div class="flex justify-center gap-4 m-4 mb-12">
    <button
      (click)="prevPage()"
      [disabled]="currentPage() === 1"
      class="px-4 py-2 rounded-lg bg-gray-800 disabled:bg-gray-300 text-white text-sm hover:bg-gray-900 transition cursor-pointer disabled:cursor-not-allowed select-none"
    >
      Anterior
    </button>
    <div class="flex items-center px-4 py-2 text-gray-700 text-sm">
      Página {{ currentPage() }} de {{ totalPages() }}
    </div>
    <button
      (click)="nextPage()"
      [disabled]="currentPage() === totalPages()"
      class="px-4 py-2 rounded-lg bg-gray-800 disabled:bg-gray-300 text-white text-sm hover:bg-gray-900 transition cursor-pointer disabled:cursor-not-allowed select-none"
    >
      Próxima
    </button>
  </div>
  }
</section>
