<app-container>
  <article class="mt-10">
    @if (postIsLoading()) {
    <p>Carregando...</p>
    } @else if (postIsError()) {
    <p>Erro ao carregar</p>
    } @else {
    <div class="flex flex-col gap-8">
      <div class="flex flex-col gap-6">
        <h1 class="text-4xl font-bold">{{ postData()?.title }}</h1>
        <a
          [href]="'posts/user/' + postData()?.id"
          class="flex gap-2 items-center cursor-pointer"
        >
          <div
            class="h-10 w-10 bg-slate-900 rounded-full flex items-center justify-center"
          >
            <p class="text-lg font-medium text-white">
              {{ authorData()?.name?.charAt(0) }}
            </p>
          </div>
          <address class="not-italic flex flex-col">
            <h3 class="text-md underline">
              Escrito por {{ authorData()?.name }}
            </h3>
            <div class="text-sm text-slate-700 flex gap-2">
              <p>{{ authorData()?.address?.city }}</p>
              <span>-</span>
              <p>{{ authorData()?.website }}</p>
            </div>
          </address>
        </a>
      </div>
    </div>
    <section class="my-10 h-[300px] overflow-hidden rounded-md">
      <img
        src="https://picsum.photos/200/300"
        alt="Imagem ilustrativa da notícia"
        class="w-full h-full object-cover"
      />
    </section>
    <section class="mt-6">
      <p class="text-2xl leading-9">{{ postData()?.body }}</p>
    </section>
    }
  </article>
  <section class="mt-8 mb-10">
    @if (commentsIsLoading()) {
    <p>Carregando...</p>
    } @else if (commentsIsError()) {
    <p>Erro ao carregar comentários</p>
    } @else {
    <section class="flex flex-col gap-8" aria-label="Comentários">
      <h2 class="text-xl font-semibold text-slate-800">
        Comentários ({{ commentsData().length }})
      </h2>
      <form (submit)="submitComment($event)" class="flex flex-col gap-4">
        <div class="flex flex-col gap-2">
          <input
            type="text"
            id="name"
            name="name"
            class="border border-slate-300 rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-slate-800 transition"
            placeholder="Qual seu nome?"
            required
          />
        </div>
        <div class="flex flex-col gap-2">
          <label for="message" class="text-sm text-slate-600">Comentário</label>
          <textarea
            id="message"
            name="message"
            rows="4"
            class="border border-slate-300 rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-slate-800 transition resize-none"
            placeholder="Escreva seu comentário..."
            required
          ></textarea>
        </div>

        <div class="flex justify-end">
          <button
            type="submit"
            class="px-6 py-2 rounded-lg bg-slate-800 text-white text-sm hover:bg-slate-900 transition cursor-pointer"
          >
            Publicar comentário
          </button>
        </div>
      </form>
      @for (comment of commentsData(); track $index) {
      <article class="flex flex-col items-start gap-2">
        <header class="flex gap-3 items-center">
          <div
            class="h-8 w-8 bg-slate-900 rounded-full flex items-center justify-center"
          >
            <p class="text-xs text-white">
              {{ comment?.name?.charAt(0)?.toUpperCase() }}
            </p>
          </div>
          <div class="flex flex-col">
            <p class="text-sm font-medium">{{ comment.name }}</p>
            <p class="text-sm text-slate-500">
              {{ comment.email.toLowerCase() }}
            </p>
          </div>
        </header>
        <p class="text-sm">
          {{ comment.body }}
        </p>
      </article>
      <hr class="border-slate-200" />
      }
      <p class="mx-auto text-sm text-slate-500">Final da lista</p>
    </section>
    }
  </section>
</app-container>
